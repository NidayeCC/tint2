module.exports = (function() {
  if(global.__TINT.Utilities) {
    return global.__TINT.Utilities;
  }
  var $ = process.bridge.dotnet;
  var $$ = process.bridge.win32;
  var assert = require('assert');
  var baseUtilities = require('Utilities_base');
  var path = require('path');

  function wpfDeviceToLogicalPx(w,p) {
    var t = $.System.Windows.PresentationSource.FromVisual(w).CompositionTarget.TransformFromDevice;
    return t.Transform(p);
  }

  function getImageFromString(e) {
    var imageRef = null;
    switch(e) {
      case 'action':
        imageRef = $.TintInterop.Shell.GetIconFromFile("C:\\Windows\\System32\\imageres.dll", -86);
        break;

      case 'add':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAAC4AAAAuCAYAAABXuSs3AAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAASBJREFUeNpi/P//PwMp4Pv37w1Aqp6BuqCRk5OzgRQNTAxDFIw6nN6AhVIDFp6aD8akgL7AiQwG0oajSWXU4aMOH3X4qMOpUI5D2x6kAAcauMOBVHew0KDBRA6wh+LRND502iqktjsuPD1PsqU7r29nuPj0AtHqxXklGDw0PVHEGL99+4bSk3CaYjfoQldf2oChP3DSaBofdfiow0cdPurwUYePOnzkORyjrUJqownUYNp5YwdJerJtcxmURVSIVs/DzsOgIqKKv3VI6ggTKa08GAA5enQkayh2JBrJ6CzbU9kdB4H4AEkOJ3UmANobp7bDD4zOSIw6fNThow4f+HKcIgAarAGNe5ACQG2PAXc4aIQJfZRpNKmMOnwQAYAAAwA5PUMAIbMrNQAAAABJRU5ErkJggg==';
        break;

      case 'advanced':
        imageRef = $.TintInterop.Shell.GetIconFromFile("C:\\Windows\\System32\\imageres.dll", -114);
        break;

      case 'application':
        imageRef = $.TintInterop.Shell.GetIconFromFile("C:\\Windows\\System32\\imageres.dll", -15);
        break;

      case 'back-inverse':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAADoAAAA6CAYAAADhu0ooAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABRtJREFUeNrUm79PFEEUx4fLNYTirKAi/Gi0gHglVGCggERzp/4BIAnXenRISDwr0AZtjwYbOvUummgB8aCBkgM00gC2VFIQEixwvussmRvezO7ezt3tvuRFsnfgfvb9mDfvzbZdX18z23J5ednL/xnlmpY0ZfiVLa5/uO5xrbS3t1ds31ObLVABl+ea5doT8s+dcy1BOXQpEqAcEJYrcB1hjZHfXN9yXePQf5oO2gRAysoFDvu2KaAc8A6eLteM6XsXFxfs4OCAHR8fs/39fefa4eFhzXf6+vpYR0cH6+/vd3RwcJB1dXV53UIVIRI0jgOBCiuWdIkFcDs7O2x3d9fReqSzs5ONj4+zsbExL+hXHLZgHZRDItGs6ADL5bKj+NmWDA0NsUwm41jakK2zfmLXFyiHhKtOUZ8Bbn193SqgKrBuLpdz3FzjyqNesJ6gOkjE3srKCjs5OWlKJgLk3NycY+V6YI2gOsiNjQ22urraUCuarAvgoLBaUF1Mwk2hrRRk6+XlZcqVqxw07RtUZNfv6nW46ubmJouCGGDfcdi8ejGhWSdLlCWjAglBbpifn6fC5zlnyHqCimIgpcZkq91VBwsvoxiEwWhQ4bIZNbsi8URVUJhgiVMkJcpTrUULVFy2IrsGERgCBiFcuPdWMqISkI0Mi6Tx8OEj43e+fPkcej0eGBhwkpMi73limsYPSZ013bIuLOTr5TcsmUxqv/Pr6JeVogMbBuQS1MmSTHEDYsdzmpA2zSNqaRfGZf1CLiy8sObCGu+blmM0b9OarYCEnJ2dUbumGtCadQdbrXqt2SpIeSlUpId7bDoh3LZHTdlxhHTvnTDSaEJ062rcth7QKEDKHqlIFqA1RTDaH3GG1DCkb4ESC2+sIDWgqaQK6jaybEFC7t29xz5++GQV5snTx8bsSxX1qUYlnlaK6pkJqsKIO6SbVL22abGHpCQwaHd3d+wg6wLd3t5mxdVi/EHhml7y7dvX2MHeAtU0iWMHq3b3EWzoh953L2DY4yfzurCQ3GzOc1fx4+cPaxB/r66Mn1PGAuipChpE/MBicFQql26+22ihwg+uu2cyuS03xoOYmJhsCujw8LB6aQugFfkKRnWwQJxhCWPtJcRA9Vy+qvRdYgULIxHhV3Gzbk1nHoOceqXVsJinKnKOAx8kKNxXM56LNCyyLeGNpZt1VBxx+e3xZCIPi3smlpY1d3mRL7yUAxouHGaw5C4nj7P6veMkBz2y0NsFIGGcLfdQh9ypvyPW1JS81ZmZmYn8SAKSz+cpt33ggt6UgGJSXFCf0uzsbOQhkU8IyC35iE5NrSsOK1XVpSZMFm60YDnRjPrzXtu0W9Ni/CE/u5pmCzxucXFRN/XeM4IKc79Sr2NSFSVYwC0tLVHFQZUa7ZsOawB4RO3DYJzerCM3dUCiwktjehakw5BV4xX/ASwbppiwEZMaSOeeKUijRaUlpyJv41zBtK3ZI388YOQLTXPgGYdc0/2un5NjWlj0TovFou+NehhXxTJn2GwYIX2BesFC3FMrVIfcRrWjKe3cmMz6OdIa9Bgr1tnnus8xhQN0vWNHOQ4BBwsaelhVU0yGAhWwWUacRVKzM0Z3GPZAvSwNGCxd6AygxvbRziFPh1kFlVy5YLIuFc9UzRywdYPzuXm1GGgYqATcK4CnGpxwAVgI85qIlddBBPC00B5LcO4rIWs23oNps/2CDw5GsP/HBRDLXi/2UJZzX/Ip2byvfwIMAOoU1y8qU0y0AAAAAElFTkSuQmCC';
        break;

      case 'back':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAABsAAAA1CAYAAACwcpATAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAVJJREFUeNq82D8OgjAUBvBKXJgcuYYjOxfRG8jI5sA99CiyMXoCdnYIIxYiBkuhBb6vTZoS/uSXJrTv9R3athXs1jTNWQ73Axv7Qi/Z31RsBJ1kz2iYAgkapoE42AyExxYgLGaAcJgFhMEsoR7zGFBRFCJN08n7HgNKkkRUVYXBTFBd19rvPFfQamwPtArbC1ljCMgKQ0FGDAktYmhoFmNAWowFTTAm9IexoR/mAuoxV9AwswlUliUcGrCbejMIAhGGITzF83zff8rxqj6I41hEUQSfmXAF/n59F+DfomaDk+2KCWo3YhY4G2IY4GLwRIPGtAAJWiU8KNA6lUOAq5LUveDq9HsPuOlgsRU8bl2gHSgDb3f5UMEhJqoNcfK8qGDX8jxXYyLsTK0FmdUCEwivgyyBlArPHEirXelAalVOBTN2vXEMZi4qqQPIx0bg5SPAAAD1gk0U24JqAAAAAElFTkSuQmCC';
        break;

      case 'bookmarks':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAADIAAAAoCAYAAAC8cqlMAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAfZJREFUeNpi/Pbt238G6oOLQHwAiCdwcnI+AAl8//5dAUgVALEDEOtT20JGGnkEGTRC6XpaWkIPj9AFMDEME8CCLuDj40O2Ydzc3Ay6uroM/v7+YBobuHz5MsPGjRsZTpw4QZHDt2zZgt8jlICvX7+CHQjCzs7ODIWFhSjy/f39DHv37h1aSQvkYJDD6eEJqscINs+AkhuMTdc8gg5KS8sYVJRV8Kr58uULw/z58xiuXL2CIbdp0yac+uzs7Bj8/QIYeHh48Jp/5+4dhu7uLso8AvKEqKgoXjUg+aamZoZdu3YyzJg5g6gQrKysYjA1MR2cecTNzZ1BR1uHoDoPD0+qeoImmb2goJCgmpDgkMFfagkJCVFFzYit2Uc9MuqRUY+MemTUI6MeGfXIqEdGPTLqkVGPDDlAsM/e0dnOwM3FTdCg+w/ug8e1xMTECKrNyExnePXqFXiERVFBkaD6r9++Uu6R+/fvkxQyIAcSqwbkcWwjL6N5ZFjmkaioKIoMBA3W3bt3D5wkQUkHGYDzhKIig5KSEsFBOVIBTedHQIPZs2bNArPT0tIYLCwsaBYjNJ/oefnyJZgWFxenadIaNjNWoDzSSKEZCkAcT6EZC4H4AUUx8v8/5RECnbFtIMNDIA80wGZ+B9wjWDykQEDpA2p5AAYAAgwApperYHRMIXcAAAAASUVORK5CYII=';
        break;

      case 'caution':
        imageRef = $.TintInterop.Shell.GetSystemIcon($$.shell32.SHSTOCKICONID.SIID_WARNING);
        break;

      case 'colors':
        imageRef = $.TintInterop.Shell.GetIconFromFile("C:\\Windows\\System32\\imageres.dll", -168);
        break;

      case 'computer':
        imageRef = $.TintInterop.Shell.GetSystemIcon($$.shell32.SHSTOCKICONID.SIID_DESKTOPPC);
        break;

      case 'everyone':
        imageRef = $.TintInterop.Shell.GetSystemIcon($$.shell32.SHSTOCKICONID.SIID_WORLD);
        break;

      case 'folder':
        imageRef = $.TintInterop.Shell.GetSystemIcon($$.shell32.SHSTOCKICONID.SIID_FOLDER);
        break;

      case 'fonts':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3dJREFUeNrsWTFs2kAUdawsFgPtEsYEZiAZw1SkMCLFMwzxwlwzRkIq3bJBZ5YuYSYSYzKTsRLMoI5kypIwEv8KKnP+/+58dw4e+IuVwz773Xvv/3+Xo/V6benEarX6HVxuYj72y3Ec3zIYRwaAvAaXbMzH/gZAzkwCsTVBXCiAgDgNnnVTAyQId0/PmpVWsKp/gst5eOzh4cEaDAY793U6Hevy8hKb4msgsde9MhKA+MKCgHh8fIzcOxqNqGm8NEgrIo3lcmktFovIjbPZzJrP59gcfhqAVNmBp6cn8maQHGH6i9QxgskqDBIYS4oVW9EfkbQL0nl5eeE+RzDmbvy2F0ZisRGW19vbGzucNZGKjQHh+WMbAGIymSQiL1tBVpG0+/z8jK00GsPhEBs+1zW9bYINYpXRAB8BcNOsqACpsnIhPowMokBqmV6bEWBDVlaCAqllejumPyJpNy4bggLZ/SxGXJGsisWi1EREgYRKX/10IFjtqNVq1tXVlTQYU42kHUNWkbTLAslkMv+AXF9fS8sL8ddN8K6zJBlxRZ3ulolCoSAlMU6B9JIEUhXJIswEMKNRIL1PY4SVVT6ft3K53A6Qk5MT1QIJpveMA2HTLtbpYr6Q9QpRIL0kGHFFJq9UKmgGg99kCiSSir/FScVKQFh/wMEC9sEwRhw6GPeKLSGrnbSLdbo8CTUaDemaopOK7bhssOkSTA7plgpIALLVnmhbfFNAqrzeSsbQzWZTB4gn0xULD+jCZ7tg8n6/byUZvu9jNein4zhdZUY257NZ3U43ThCm90Ws2LL+UNlAqQTUp+l0iu1VPCUgmxVwVbazunF/f4/uVXisHAvYyFJGhPrAy1YxpYMWyHDLs/kWn9p88YB0eZ1uq9ViXyQVMJfM0REAbrfbmFf62Am+TcgK9HhKmRzqggqIOF0xUSCzFCM24Y0+L7/LfgwWpVJJt0B+x3qw42Cwi/Q3ZKe73QXqBDwPPpABQrQ4I5AY65EfvMnYTle2CRQBAQ+IDr1BWvB+ZOGy7HcLWxSVlkQmZOeRyXJCILAa7KqppFwsZOeB9/d6PeF9R+/v72tqBbBTDjBquVz+/zdsZ3meodItFFjs33RUsO9hvRMBUq/XY60sALu7uyN/h3bj9vbWePUfj8daB3SpjQOQtEXEIwdGDkAOQHbiQ4ABABM06TdZwKnTAAAAAElFTkSuQmCC';
        break;

      case 'forward-inverse':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAADoAAAA6CAYAAADhu0ooAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABShJREFUeNrcm79P20AUx48oC2UIE7QTP6ZSgZoRuhQEQzsl/wGQiqyEjSLaplIptAt0DQtdmMPUDqAGhARjAgztwq8BCRbKgBjpfd1z5RzvznFyNnaf9ASyk9gfvx/37t656fb2lpmWm5ubTv5nkGvSoQnNVza5/uZa5lpqbm4umb6nJlOgAi7HNc21o8Gfu+JahHLoYihAOSAsl+f6nPkjJ1yXuK5w6N+BgwYASFk5z2GXAgHlgK14ulxTus9dX1+z/f19dnh4yPb29qxjBwcHVZ/p6upiLS0trLu729K+vj7W3t7udgsVhIjXOPYEKqxYVCUWwO3s7LDd3V1L65G2tjY2MjLChoeH3aDfc9i8cVAOiUSzqAJcW1uzFP+bkv7+fpZKpSxLa7J1upbYrQmUQ8JVR6lzq6urxgFlgXWz2azl5gpXHnSDdQVVQSL2FhcX2dHRUSCZCJATExOWW9cDqwVVQa6vr7Pl5WVfraiz7tTUlGdYJagqJuGq0PsUZOuFhQXKlSscNFkzqMiuP+TjcNWNjQ0WBtHAfuGwOflgTDFOFilLhgUSgtwwPT1Nhc8kZ0i7gopiICHH5H27qwoWXkYxCIPRoMJlU3J2ReIJq6AwwfAmSUKUp0qL5qm4vI/s6kVgCBiEcOHOO8mISkCmMmwm80o12P9NlZUy29raaugavb29VnKS5CtPTGP4J66ypl3WmZCzszOWncgqzw8NDrEHD1rY9+/f6r4GJgzIJVJBMcoNiBnPccwxaa6abpks6wBQWC5oP4MH8eLFy4auo/C+MWeM5vyyZpCwFxcX1KypCrRq3MFUy48EFAQs3FeSDu6xyZhw2w45ZfslfsPi3gkjDcbEal2V2/oJGgQsPFKSNECrimAsfwQhfsISDMk7oMTAGzlYAjQRl0HthSyVfPgwx570PAm08rHH4FrHWWRfqqhPsAiIV8vKnhmjKoz/AVbOvDEWMak3QUUOFPJs4Nn/D/rz10/29t2bxkGxFhNmyJmZ13V99w6obt4YJUh5dR/jKNZDn9oH0OzRZV6MZefn58YAHj18yB4/7jEKSRkLoMcyqE62t7ctNSEIk08Ln427KxV+cN2yzuR+iQ0Zj8eNx+TAwIB8aBOgJecRtOrQuosqpMJY5ZhoqF45jyoaOZGAhJGI8CvZWbdqZR6NnChCQtBPleQKGz5IULgvmrBRg0S2Jbyx+G8cFVtcTlyeTKgh7XsmhpYVe3hxHnjnDGi4sInG0vh4hl1eXirPn56esLmPcw1dA4CEcTbtTR3OlfpWMaYmnFOdTCYT+pYEJJfLUW47ZIP+KwFFpzgvPyW008MuyCcE5KZzi05VrSs2K1XkocavLGxCMJwoWv05t2nanW4xfiiMsxp43OzsrKrrXdaCCnO/l4+jUxUmWMDNz89TxUGFau3rNmsA+Lm8DoN2elBbbuqARIWXRPfMywpDWo5XXACWNV1MeI1JBaR1zxSk1qKOIafknMbZgm5b0C1/PGDkC8XiwDiHXFF9t5adY0pYrJ0WCgXfl0hddo25QtYE6gYLsXetUCvkJqodRWlnx2S6li2tXrexYpydVJ1HFw7QjXbjEIeAgwU1a1gVXUw2BCpg04zYiyRnZ7Tu0OyBulkaMBi6sDKAGtttOYcpdocZBXW4cl5nXSqeqZrZ49IN9ufm5GLAN1AHcKcAHvU54QIw38hrIkZeBxHAY0I7DMHZr4SsmHgPpsn0Cz7YGMH+bhdALLu92ENZzn7Jp2jyvv4IMAD+6tbebCjZ9AAAAABJRU5ErkJggg==';
        break;

      case 'forward':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAABsAAAA1CAYAAACwcpATAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAATRJREFUeNq81bGthDAMBmCfOzaifAU9I7wJkCgZ443AOJS3ATNcQSh5h3QnobsE7Ph3LEUEJ9InxYZQCGHcto1KDCai33VdRyoQ/HoWAfkwdwf5490V5EjODeRE3gXkkzU4yBfrUJAFe2DgF9Z1HS3L4gJ+YfM80zAMLmD0GL3AZM08wNMGQYOX3YgEJa0PA1m6EQGy5hisIGuLbAE5p4VzQc79QHNAtvx+tKAJ04JmTANCMCkIw45g4gL+g2J7tG0bSz+eY4Rifd9T0zQx6KeqqjuXgmA1k0AQTAqZMQ1kwrRQNpYDZWG5kBqzQCrMCokxBCTCUNAlhoROMTSUxDygPW4hhO2YmKaJ6rqGQ1EscfGZIUk3wqArDAqdYXAohblAMcwN+sRcoSPmDr2xItAe/wIMAHEdh+l2NJkvAAAAAElFTkSuQmCC';
        break;

      case 'general':
        imageRef = $.TintInterop.Shell.GetIconFromFile("C:\\Windows\\System32\\imageres.dll", -27);
        break;

      case 'group':
        imageRef = $.TintInterop.Shell.GetSystemIcon($$.shell32.SHSTOCKICONID.SIID_USERS);
        break;

      case 'home':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAiNJREFUeNrs2r9qwkAYAPDzQwvBpUN1rT6A9A1EUKx9Bfc62cHNpaL2AexswUXwFeqgYDfXQgp1cauDS+uiUIf0LkQJxks8k7tL4T44khj1vh93en80YhgGCjo2m80lPkxwuTm49Y5LDpdvxrd80zQt5/YEEIhA1mMTxCFAIMKOCS/kRAS3iPJGdDod81ir1aivr9frSNf1/XW5XDaLUIgXYjwe76/dMFK7FguCnO9aJ1QQFoQIDIhC8MaASARPDPBGlEp3ZuGNifJGVO4r++vh8NWBEQoJArE754UBEQg75lg34w4JEuETk7JyYYfwQPjAXJNc3DAgGnEKZj6f02bNVAzIQHhhptMp7auZigFZCC+MyzhzFAMyEUFiQDYiKExkvV5LR9ij+9J1DJok8vk8bT1jbmgAKyKbzXJD7FqG1MHaMsA6iy0Wb7mvv2l1uGHg3Km4rKBhHJBMJoOSyWRoISQ3kqPn7LdQKJhlNBqhwWCAlstlaABkZ4XkRhvZW7isjoF6vR5Kp9PSESQHkgsFQXJvgaZpTTK7pIHi8bh0CCWHlZVzihjMroVPfvChiQeXZ8S+weyIRuPR9X67/RSEL2Xl7fyMkBsY47sG/UPn3kp2hO8NujCFgiiIgiiIgiiIgqAzfkOczT5R4ipBvb/d/nq+x2LxhWKxC9c6uEP6/b5Z/ET1oaq6loL8l4gc/jsIr0eM/5A4Xo9EVNdSEAHxJ8AAHeqE1zx+6gcAAAAASUVORK5CYII=';
        break;

      case 'info':
        imageRef = $.TintInterop.Shell.GetSystemIcon($$.shell32.SHSTOCKICONID.SIID_INFO);
        break;

      case 'lock':
        imageRef = $.TintInterop.Shell.GetSystemIcon($$.shell32.SHSTOCKICONID.SIID_LOCK);
        break;

      case 'network':
        imageRef = $.TintInterop.Shell.GetSystemIcon($$.shell32.SHSTOCKICONID.SIID_MYNETWORK);
        break;

      case 'reload-inverse':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABLRJREFUeNrMmj1II0EUx8fFRhTuKi2j1n7kOq0uoKWYXCVocZ5iHzsF4RQE7RKwU0Sv0FrFUiFWWubU2miplYIfpTf/ZTZsJu/Nzm52k3swhGx2d+Y37817b96k7fPzU3Dy8fHxVX6UZUuJZORCtiO0jo6O+0Ze1MaBKIiSbMOiOQKoogQ6ihsEL8yK5stf2fISqNQwiITYlx8/RWvlWLZZCfQcCURC5OVHwX/t7u5OLC8vi7e3t0gjOj09rfk+NTUlBgcH3TYyMiJ6enq4Rx9ky0mYcigQCTErP/bihKBAJiYmar4DJpvNumCEvChT2zf10e6DSCcBYSNXV1duGxgYEIuLi7qGvmBccnzCBOP4IEqtgPDL7e2tmJ+fF8fHx9TPe8piaBDlZo8Uecsg/LKzsyPW19ep/vfUpJMaKfkDXqsh/Oa2tLREjaOkJr92sb+/v9e4LaiVgzD9FmaxY5DX19fi/Pw88H19fX1ic3NTdHZ21gxFrpecEYSTQqHgdhyH1/LL2dmZODw8FE9PT+w9Y2NjrhPQ5Ic/C3CShgiS8fFxsbW15Q6WE/RNOIBindcyCWbLBqK7uzsyDMwGM57P543j0Mww5fdiRpCbmxv3BSZBMNvd3XVnNg7tcDCA2N7e1i+vBoLgQZiUaRZXVlbcZkgxIsFMTk6yJvb4+KhrJeeBXKhW56G4BQiIjY0NVxtJyMzMDGuqxFpxzcuRKz+jLxxog4muVYj+/v7EYgj6mJ6eZuOLJlm/aRV1l8j5d3SQJITfxCitwEoQtLWMPeeokJ8KUJ8rSOqQpYYRkycKEs50Ca2koZGMnixyawO2GxaiEW82OjpKXtc1AgaApHWXy6UKzH4hEQgI19/r66t+qRcgvTYgYQYVB4R/4VPpviapOo0QtMbZSRLCswQbcfz7EIbWFRtPFTeE56VspN3mJps8ivP7pqwXgwx6jgKhzM2JCyQsRLFYDLyP8E6suVmBVCqVpkOYHE9XV1cwCIIelUA2G8K739LxPDg2tKbZSQoC/XGWQIDcO6oAFuidLi8vmwYBOTg4YNcrMcYSQMoR8xtrCQuBXI8LA0yuV3b0whxoKfcGN8jZbJwCT8XtSjEuJk6V6kC8qoXlvjl2CFNNDdogJvkCFXtHnUO8WKjP1Qpnu3EU5EwQWBvMuPb97rfmlAh7cE4rJycnsZoY9uAojzIl0qqgykKZvDd291hBbq6QAVf02DE3N8e+PExepR8j+GfZJpdaWFjgtPFHWtRsVSPqIPLCdt/seSJUWRpZMzYQsAzTrlQqYRWtetBDaQUSVGXErALYpB1OIzYQRKmUFP3ECgWv37qJoSoelG9Bg+h4aGioLhZFAcH7OE1Qv1FniAiQw1FgPAk6amt0x0iVo6jsN6e7YzyM0n5SBblGIUgQtfAzFAzKo/Ag/xsEux9Rx8F1MF6wRNGaSvdbBIExfmM3ViYYBEyYWpL1X0sI/Esig7Ea9+y4QbllRM/v1L4ADdEZKQb2EI3uWyJAPJNeyxB4UPtc1asuLZJqRA+1Z1faKapi3hplbk2UNR0ilEY07eB4GC+DllJNhPjF/fshEogGlVaxJ0Oto5jkxVvU3A3/BBgAc62kb4b6R7IAAAAASUVORK5CYII=';
        break;

      case 'reload':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAAC8AAAA4CAYAAABt9KGPAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABa1JREFUeNrUWj1MG0sQPiw3CCSooCRQg+LXQZWToLdfS8NFCDqI3UGBQiQk6PCjBAlMAe0z1CCcCrpnfmowJVRYAlGS/U576Dye2duzz3lhpJVFNra/nf3mm59z19vbm5OUvb6+VtTLF/LP+2rlu7u7n5yELeV03mbUqqiD9X9E8LDPatXUATIfETysT63/1AG8jwg+sD11gOIfD/7o6Mi5vr7mtr6pA5TbjYOOgn95eXGWl5f9QzCW1YGc+aNps7Oz42xubkqBjAO4/yt4BeCTehFpcHp66iwsLPi3wQTyWSuBnGoTsIvgU6um/rzTnhTt7u7OP8Dt7a0UyKWOg4eXNOAzBJ9aQ7bvfXx89OPg4uKCTWjI0raBnGoR9F4cwFwgr62tOYeHh9w2youqTSB32dQ2ms8lpm5pAgVKPDw8+B6+urpybm5ujJ89OTnpzM/POz09PXSrrpanaqJyy+C1EpR1YDUZwJ6cnPh6Dk63YsPDw87GxgZ3AFhBHaAYG7xWgD1uD2APDg4iPWtrAL6+vu6MjIxw2/vqAJ41eAk4KAHNTgo0tXw+70xNTXFbl2q54dI6HQc46IGEw2h1IjYwMCB5HlalPUGT53WUVyjHoQyCOiRiEbz/qoCXjLTR+lqlMgiaIEN2yqA4hUKB24Li5BTwCrdJabNKgYMqtsDhtfHxcWdwcNAZGxuzeu/c3JyTzWYljkMqq9J700TLv1FFKRaLVlydnp5uCjShHH4/KLyNwzL2U3vc2PemidcbEo5QCdp6zshvABeC8x8FOh+VNNX/qaVDXp+hjQSyZIu6LNro6KizsrISKzBDGD29QKVc4Pk89brQQLQFPCIwXY7fCnROAw5fb3+YNh71uknLhSuvh+rzuMkH/K4JXuYKwD5Ielrreh9VGJP3mCC7BwC1irR4i0r74YGUrqM8SmHB3LT+0oZCy8R1qIpw5ZjLNGwA8NbWli+djP1Q71lFblErr6kbp8zOALxrK2/wOgOk4crDJshgXXu7ZCr8qEOxCO18z3+yBT8xMdGkx1L2E+xeHzYIzCdTb3B+fu7HH0ptyCsBP5SmV/X8/Cx+M7ImsTg9Z1NViBEg52UARpsYFg2uV0hzTbKURRltLlsCZ+tx3ACNk+3tbetyO8VdlwSe+XKbsXWBA05u5N16e3uN3P9dQycE5t9SCxeyJ6pQiY8+uBsxjCgCftvQqkEw0LRLRg+W4moPaWDEJQqhInRNpSzJpEM2tJU8X7flHCOjOfJ3UYF2YzzC8ShwSTAglRz4qi3nmLJhJjwktaRJmHINBSF0XTImOdZTul+Nyoq+Ue0NvN3inL3M9cmSMbgqTeDheU4WDaVyMKbut/W4Hqh+obdqqqmYBFlJ6fRet/U+vMNMeYMHZp7F9K1Cq0Y4BSMVk9cZ2pT96YH2xEx4sDQ7O2tsRnZ3d6Vu6F5ToqrTP24ko4P7M3ebS0tLxlEhSmri+Uvl9EwglUUaHKggTZqPL8QhGRvSjTyqRYzA/1Xre6vAId0MZYrvOq81+Wd4V5jcNuj+4uKiNGePNFAvCniAg95s0Oe+D500H8+oumCOHmXgJJoUm9SO20Lc2MyC8JlM8/O1Cbw+QJk0un6Vd3x8bD3SQM0fXDNe4WHQAwkOOm47BgddMP6jZQe4bhr31aj+dnrcF2Nu+Ve47EgxJa7HTQtMAfybgBdovcTO53VDvMlpfCcnxYZHPLEfLpS4EQS4CxqZsmFci5hbHingOW4j6rFOSZqhIJ3jFto5BEBjzoklyPK+qQuzeaBmHE/gEJBU3IhtLQ4PY0GZDLkkcuBq+ygzo1O+cSiEAwSPMTkvIw8w2ZJrHz2b8rrL9jdmofr7ewfFJtbv0bri/kBOt26rutDqSxD0qjR5Sww8uYmcXtkWPuJSD63KcUG3DV6o1d1QCUytphfq+WoSP1X8JcAA/hpP7IDz1dMAAAAASUVORK5CYII=';
        break;

      case 'remove':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAAC4AAAAVCAIAAAC2ZksOAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEpJREFUeNpi/PbtG8PgAEwMgwaMOgUbYEHm+Pj40NNuHR2djo6O0QgadcqoU0adMuqU0ToIUinQ024lJSVkLuNo02nUKUQCgAADAAUvCds2f1cjAAAAAElFTkSuQmCC';
        break;

      case 'reveal':
        imageRef = $.TintInterop.Shell.GetIconFromFile("C:\\Windows\\System32\\imageres.dll", -177);
        break;

      case 'share':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAADQAAAAyCAYAAAATIfj2AAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAjtJREFUeNrsmbFuwjAQhl3EghjajRlmoH2DVoIRic4spQsr4Q3aJ4CuMFAW9iBGkOjGWCFm1BW2LjC2/hFUkTGNndhpkvqkGzDk7A+fz3eXi+12+0XCJ8+pVOrJy4MJEjMxQGGXJDtQqVQCX0StVtur2SEDFIczxEo+nyfFYlHrIgqFQnBAgFF1YP+zy13FDai52+3qWlyOI29UZ47PN1Sr7I9WqxWZz+dCBtPpNKlWT0z0KRShOd2rbqAZmzjSiTHpg3Msl8sR27bJdDoVMoo/oNVq+YZS4nJ0QrjHgB3HAkulkpANgLfbbd5XfRn3U3aGwgLlxeXuqPFztcoH1U+qlyzUccEiUM5nZN3PC9DtQaUEC8ThH41GWqECDduNRoNYlqXV/QK/h8rlslYoaZdbr9dks9n4gspkMvtAoeNMSQNhguFwGOiuYk7cayKXb2TKh16vRyaTiav7Raoe6nQ6rlBJEjEB1DG48NwvkhUr8r7YlOCIjrjPOPKI4JCIGgwnfP/ARGqHRGA8BQUYVtHUQLQSrZVEYTwB4ZaHhhHmT1wOMMfQqxomcCBFMC+/lQ8qmiSs3FO91gQzoDCW9iaJo1lS1wzjWoYrS30OMH12vNvtClWpKmCUAZ2DQXEmGs2y2axvGFVNErRtm7x8C+FdtC/OqXWkYbQ2SVCQQX2INEyYUx/bC0yYgd69PujqcovFQvvqkRuqeunlCrRcLveqUxA4VAGZl8YGKGA5OUPj8djskAEyQOLyLcAArBMX6fpPZU0AAAAASUVORK5CYII=';
        break;

      case 'status-available':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA9pJREFUeNrcmj1IHEEUx5+LBvwIRhuNRTTBA5vgLWiTQs7ClBoEOws/QLDw0tt4IthYqZ2gXCGkECS2schhIJWwJ2mEk+ClMNpEJX5ALMy8Y1Z3Z9/c7ro73p4PluV27nb/v/vP25l9sxW3t7cQNK6vr1+wXYJtccu+XvL1c7Zl2ZYx99XV1WdBNVQEAWEAH9huhG0DAXVssS3NgD4/KggDQPEptrVCuJHH8zKgtFIQBoDdJq0AgAIaYUCZUEF4DqADH4t9zzgxwDg2IHeag4t/F5A9ydra401xqHtWB7GGGOjNOuhNutulF7lDZ4FBOAT+M51Ue+5PDjb2N2Dn1w5c3lz6+ttrq2qh51UPDHUMQawxJvvaHt5A3GCKgjCIOIeopwCWdpcc//pDA91KdiVlQOccJusbRAaBXWZtb63ggopAd8Y6xwpd0A8MCcK706EIgS7Mf5+Hg9MDpZne3tAO0++mKXcQpo3qZg4QWU4gxNSXKd958NDA/Fl+v0zBkDmjEedIlRoCA6+F18RrC9HJNcod4ePE11JDeHSm1zrOiCCH1sEOExshVOXEQt8C1FU5kho29zdh++e2LWcQRrgB5BlIm/mhUph22EZsvDupghh+Owy9r3vJtrlvc7bPqAG1JLuT1sOtqNmczmhCbjgGOlUx0TVBzw5+G3D098hxHLUQ+ZKyJTufxdrcwMFOVaAbNVU1ZNtMZkb6O0JTK9d+58iI6EZYI3YYbpiBmghXCto1Pm4MiDZGzY0i2gaQQeNPdLbACWDU3HDRlnCA4FRc1ZgR1A1zoESN4pxT48/X9yDHRmTdKKIx4QDBh6KoulFEY8ERxzQ9ym5INNZr1C0uym7INGqPMfEL0w1ZVPr9wbg+DpPdk2Rb/6d+h7Cw3ZCFb0dWjVW4urki22YTsyVxgwTBIoBbrOyukMf1lzq0PG9R7galUePPwXdBPPQ7Yv3HuidXVLlBFSYQxHYLwOKZl3BzRWVuEBqzGi803Atp1j2dzM0VlblBaMw4HMEyJj4nB3VFlRuojSi1Oh3BwDJmUFdUuSHRltF4fWhLrPZ5DZkrqsYNQtsWMpi337QtmRpjnm7DflwJww3URJSF7osPfKUob23FgnKYroThBqEpb65ySasoSO61i7m5EoYbkqWHVOgFur43fTDYMSitUwUB8VKgezIlU9tcizcsil0MT+R1bHkkiEVxffHJLCs83YUeC0z5L725wZjulMViqFvOWIEivzwtwODgU74vDAhACYjoKxy+ig94Yj6ajopzsxABRvEafiB8O0I4VN6vOUlyCLtdyV48+y/AAC1PtnRJ6NFkAAAAAElFTkSuQmCC';
        break;

      case 'status-none':
        imageRef = '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';
        break;

      case 'status-partially-available':
        imageRef = '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';
        break;

      case 'status-unavailable':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABHRJREFUeNrcmk1oE0EUxyfbVk21SQtFFLXtuVqTYz0o8WL10nryJqSKICgUFMFDwQqCgigEFARRAoIHT7YIWi8GPVhvrVLPbfEotEk1Udoa579Mkt3Zmd2d2d1+PVgS2tmZ99v33rw3bxOrVqskqFQqlXb6kaFX2vKZlAwv0muaXoXaZzweXwqqQywICAU4Sz+y9BoKqMc4vfIU6PW6glAAKD9Gr24SrsxjXgqUjxSEAsBt8hEAiICyFKgQKgiLAVhgxG3c6uePZGXqE1mbnSHVUpGs0u9Wae4/TmKJJGk6nCIt9HvzsRNeS+eYhZYCgzAIPJmU6P9rs1/Jn2ePyMrkBKkul9TcoS1BWgYGya6LVyncUdmwGWwgXjCuIBQizSCSIoDy7RuOp64rsFbrrfsyoCKDmVYGkUHAZSoP75C/zx9HEhw7L1wh8WujpguqwAhBmDvN8RCwwu/rl8ja92+RRnpTbx/Z/eCpyDqA6RG5mQNEFhOAWD53SjkOtPMCjZ+2V+9FMMKYMQRzjG00hOnCdC2sibU5STEd5RZheeLDRkP4tMxJa57hLZLnAxsx4QaxZ+QmMZLt2oriXszhZhlTh1KRuOlqcGWHLWNjd3IL7I4X4yQxepd0Fma0YHAP7sUcmEsm0AG6cNLNdLa7Fv3jnBUELlU60+8KET892MjqPxbIz0yK/CsuKUE0H+xqPLh3E2TxvLz+TLyd4l1snrpXT90irIq1WQPJzi+EmdCoQn4tI4KAYE43ywh06ma6110rywe4LGPDn3kIFRgZhBVGFjOrZh3n2MVM3Q2WN2z2RO0kfSr5J6YbSUsNFxgviJqLYg2ZCHQbAoPBTnQ2QQEoE8QAYkEVxi+EV5xJdMs4QFCKe+UMVZiwIGrbMXTkJG2w83WD2Gc1qwITFoSLjhkHCA5FfsUvTJgQEh1NizjKdBXxAxMmhETHZKxcLtvK38WuVu1Sw8uFwoCo57KFMvGqfrVExTJBIYQPMtQD0aEe0rR3n/c4OgZjw5TQQFqOpEnn5BcS27HDuzSnYzAW90QGgiaATnx0vHzjC8IKg3t0qmaRjgY7BzcWSCT1gnz/AXWF6D06RwBRYwIgtq4Emmdh7lQIbN3aTBpjTh2nDdZoaPi6T9dSKTt0ajPXeHTqWHBYBG1MnJPDgsAWq1toys7wglar0yIm8cBgaBBBq2afuhUM1h+yHcvQi5VJa/aydu3kFwZryESg2zgYDFFHAudi2Tb8K3fPPFvrZmwvGMyNNWTbrqAtlN9+zQdLh9FmFTSUZYIFa5bRqZ14y3hBQBeBNcZknUabVVAum21Ll94WGgU4Y+sWgLAMYkLmTuZD7e0zu41cIqxbY/u2TNk/cryLmU/DI7esM0SOf7+4fV8rsAEZvpisWQb+GrXUYkLyokf4PlF4HvGCcdvNggrmVoUQuhbnZlv/ZahXzFiBNv3raQ4GyWfr/mCAA8qQTfoTDqXmAyZm2XSYLRYFwDDWUIFQtojAQlv7Z06SGILbbdgPz/4LMAC29ESGvB5+NgAAAABJRU5ErkJggg==';
        break;

      case 'stop-inverse':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABCJJREFUeNrcmj1MGzEUx82JBYFEhBArHzMIhiIxplOZSFVGOsDC2qYToR0yNWmHpqxMWRipmkx0akYkOlDBzMfOABKIkfp/8kV3vvd8Z9+lEJ5kJdL54/3u+dnPzzfw8PAgssr9/X1B/hRlWQj9jjLVb2Q5lqUT/A4NDV1n1WEgC4gEeC1/1mUpZdSjJUtTAv38ryASAMpXZZkU+col+pVAzZ6CSABMm2YPACigdQnUyRVE+QAs8M5U7+TkxC9nZ2fi9vZWnJ6eRp7Pzs6KkZERMTMzI+bm5vySIDvKQteZQRQE3sw89RxKt1otcXh4KO7u7qxe+/DwsFhaWhKlUsmHY+QvFpAkGCOIhFhQEKMUwO7ubuytuwqstbm5yQHdKJhjaxAOAm99b29PtNvtnjjHysqKWFtb861lA0OCqOl0oUPACo1GQ5yfn/fU06enp0W5XKasA5gpaprFQDifAESlUrH2A1eBRWq1GgVD+oxH9FF9bIhgCmNMjK3JvNKRt4jaJ34/NkRKy7wM7zO6RZr6W4FPmCBW36xSjmmlKPowWYbRoUlOLRV2RHZsrE4mx65UtuUK81Y0vn13gkEbtEUf6IsT6ABdNJlUOscsUtWnlGmJxcCLLxb9/+Pj49YwAQTaQtCXCQa6EP5SjYCoKDZiDWx2aSACsYHRIQJJgiF0mlS6dy2yrluD27Exn3UIGxgOIgzD+Qx0Iqzi6+6pfSNynkDsxMnBrwNxdXXFPjfBJEFA0DfGYA8ucd1KYPDUiS4iCABNq0j5w3trmLQQ6Nu0SjK6FWMgCMOT9gxbmLwggrGhoyYLnjpfR0DS7rxpYfKCMOhYjIEQzpQZJk8IRkffIpEIFyc725goCSZPCEbHUY9a4lwCPFsYVwhORy/PaDUtTBYITnIDgUxMTIhCoZBYD3VQN0/JDQSnui/1r2JwcDCxLuqgLtr0DARJAJco9uP2p1QQYRi0cYmaKR09dQ7uCvJOLqH42NiYtUJo43IEIHS8AUgkK2HILznHTq6xGSeEjseeSjR0JUX2zzp2conNTELo2IlZBJWSOrSNnVwDTW5sAiRuEQjSmHlBZI2aU+rW8VR+KBLkIxfLyfKrZefYKS0MxuCE0K0FBo/KSMCZuGV4/8e+OPpz5LxjJ8Ggb4zBLbuEoze7+4i6KboMP0VCmZNa7XMMxibs4GDQJ/rmhNDpMrjlYrMoIEdCOQ2MS+ykwyRBQBfCGlUu03gRzqZgsK2tLWNuC4kCnLFdA0A4NnyCm05B+FOv1/VFANaYet4pU/VgR59i6ChLWrQHEDv6/eKzuVZ4vhc9IZj+v3pLggms0xeXoUk+EwZ68tfTGgw2n/79YEADKoon+gmHVfIBHavddEOPzXIE2MAYNhDWFiEs1N+fOTE+hGn3aB+e/RNgAGHfTOCi0IVLAAAAAElFTkSuQmCC';
        break;

      case 'stop':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAADEAAAAxCAYAAABznEEcAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAoBJREFUeNrEmL1qAkEQx9c1FmKRpLKOVRqJYKOdoP3lDZInkAiCiPaWprYyb5A2hWB5pU+gae0S8KMRLrtygl5O3fnSgUG8O+d/P7zdm/kngiBQLrFer+/Mx9jkJJ1OvyqBwGrcAIs/2TTfFTcIRUMDi+/ixRwfCgGANTSiOCsIh4ZGFmcB4dLQkOLz+ZwNhFNDuxafTqeqXq+rfr9PBuHW0K7F2+22Wi6XajQakUAkNDSk+C6wIFIaGlocCyKpkWy1WuDiu5jNZtuFWC6Xo6cKm83mIZVKfWIBIBrJTqfjx+0QzWbzZHFXEZNjLMC+xmKxUMViMU7j3j5Ok+iZbDarSqWS83Z56m83+U0BsJHJZFStVos79WtymLANYPh8vUSvsDdmb9A1qtWqajQaJ6/BAPR6PZXL5eIAKqa/mmwXdthofUSvsjdkb4zhHxEDONhipUGkAP697KRAJAFsJOKGIs414nmeKMBRCE4QSGAATrbiXI+WNMDZoehSIBQAp/FUGoQK4AQhCcIB4AwhAcIFAIII4y0UOQi7jUIjn8/HAdgYQwBAEHvt9G3cmxgavu8fa1E86MyugQCkbpQ6WHGbZ2QAThB9TQAuEH1tAA4QLQlgt1GuCZHNPMN0o91ul2uw4jPPMC8yxgmRzzzDvIklQfQlAKRB9KUAJEHI5plDM/dl8nH/oDXarIY1xVxC3Dxz6Eafqd3vOfNMU1ps13ZaWgNtnkHnAUkNlHmGHWikNMDmGXUik9AAmWeDwWC7wDhGSk4NsHl2ZIeoQEdKTg2wecYFwKmhCSIkAE4NrHnGAsCmYdeES65Wq6HJwOSPyYLr7yCJ1YCKvEsBUDT+BBgAZ3uKf8XFyZsAAAAASUVORK5CYII=';
        break;

      case 'trash':
        imageRef = $.TintInterop.Shell.GetIconFromFile("C:\\Windows\\System32\\imageres.dll", -55);
        break;

      case 'trash-full':
        imageRef = $.TintInterop.Shell.GetIconFromFile("C:\\Windows\\System32\\imageres.dll", -54);
        break;

      case 'unlock':
        imageRef = $.TintInterop.Shell.GetSystemIcon($$.shell32.SHSTOCKICONID.SIID_KEY);
        break;

      case 'user':
        imageRef = $.TintInterop.Shell.GetIconFromFile("C:\\Windows\\System32\\imageres.dll", -1029);
        break;

      case 'view-as-columns':
        imageRef = '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';
        break;

      case 'view-as-preview':
        imageRef = $.TintInterop.Shell.GetIconFromFile("C:\\Windows\\System32\\imageres.dll", -1001);
        break;

      case 'view-as-list':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAABAtJREFUeAHtm79qVEEUxrNgoY1oJb6AYusb2O0TWKdIEx/IQPo0Qkohjf9AEATtEtEXENZGLIKSYp0je8Lcb76z95tkjFd2Lixz58xvz59v556BcLO11a+uQFegK9AV2FwFZlj64eHh02TbRbvNl8vlwJzP2f06m7LmzGrc297efjJIIJjc3X22/Lr3uKgtwIfmJECKN73r4OBgubOzcydlu7YwK94/w8r47Bozf/rBrP/ednx8fDtl8S19hltxlZoVnmep7AQqQO7E7j++OkLTYP7w0Xwwj3iVM2fIpj25dXp6emMQKJtg8b40JoIkACbjzqNR5VUuiuP2qPh8PeoJVIAHN/2r0xk/QAP2zMaKzzkmAhXAv+Tj0dH6R2A+Hz4CEa9yFhdZewTYtSrqXr6WRPmc7Pdz2+reuC+5vRCABcJkcgfsXuVVjsUA26CobC2ynyOFALYyxVOA/TDnVVzihgqA/qKu7hw2s4hXOfOLrMdqPRYCMKVrk1F5lbOiWV4txCgEMKdTPAXet6iW+KACIBd1deewmUW8yplfZK9sB7BAmIwXHo0qr3JRnBZ2ugP6KQDSRl3dMWxmEa9y5hdZj9V6LHYAewRqk1F5lbOiWV4txCgEMKdTPAXetaiW+KACIBd1deewmUW8yplfZK9sB7BAmIwXHo0qr3JRnBZ2ugM2+hRgOyDq6v4LYDOLeJUzv8h6rNYj3QEYpDYZlVc5y4f9MJjnReZUgCmeAm9TdWdnZxepce13CgGY0lFXd8/YzCJe5cwvsiwvj3+ZsRCAOcNkGJPbVF7lct+t7wsBTOmNPgWYwlFXdxabWcSrnPlF1mO1HukOwCC1yai8ymE+LeeFAOZ8iqfAm+DP4pcVoxCAdduoq3twbGYRr3LmF1mP1XosBGABapNReZWznNgPw3KttRUCTPUUqC1M5QsB2Bejru4sNrOIVznzi6zHaj0WArCtVpuMyqtc66Jzf4UAtjjFU+B1nnXD+0IAtgOiru55YDOLeJUzv8h6rNZjIQALUJuMyquc5cR+GJZrra0QoJ8CRMKoqzuKzSziVc78IuuxWo90B2CQ2mRUXuUsnyt7BCzYFE+Bl5bYX7ikHRB1dc8Hm1nEq5z5RdZjtR4LAViA2mRUXuUsp+gRiN4SsxelsBbpLbH/7RSwoiIRcgFWb41d7C2xqKt7AGxmEa9y5hdZj8XGMRFWxdtXi7fGpEegJhmLovIqZz7HrkiEdcWbz0IAewSmeAq8GFMgraMIY8VTAWaz2d7+/v6f/xfwxjM2mqOIYWu5De/Z3GyLxeL5ycnJwu7XXS6CUrz5id69v57WbqWPjVO5fqVEvqfPz/Th780OMy0a3nC5z7oCXYGuQFegK9AV2HQFfgPBPIiBUd766wAAAABJRU5ErkJggg==';
        break;

      case 'view-as-objects':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAAjpJREFUeAHtmUFuwjAQRQP0ArDMQSqxY1OJPesegBNxiaJuK3ULR2EBN0BC0BgJKXzh8XiwflAzkRCZ2OM/fjMxIa4qP5yAE3ACPSYwiM19vV5/Nm3L5jON9cm8/tv0Xy0Wi2/Jj637JgSznM1m08lkInTRNx0Oh4/NZhMcRABNO1VXAnCd/PF4rC6Xi36mD3oOh8NqPB6HlvcHzXiJqisBuAZ2Pp8xwGw7jDEajbL8WLpJAM9mP2vWrc4s3SSAEpkYDKJrbWvK96cs3SQAVibup189ve7geDHbAcTI3K6XKMXwK5B7sHQpFWC5jSw+CFkzRhJAiUxgYBqbpZsEoKGYmpBlDIsPxqEZwwEgNbRZpdiVrlcAkke7RAX0/klQsxgheIuPZQy/BZAa2qxMdKWbrIDwP/50OmF8WbblUZilKwH42e/387qusyYb67zb7UJTeC+YOqi6EoDVdrsNwc5TESvbv5pfg5Wib1e6itC8ixNwAk7ACTgBJ/CfCER3LNi7tDeobF3pSZC6S3sD0HxTdSUA1F3aFgCqrgTgGlOJN0JhDN8dbqVYc1riPYRGh1IBvX8nqMkE9nmZCmAF8rIASiyClldiLN3kGlCiAixjWHwsVZQEUCITGJjGZukmAbAygVBYug4AyaPNKsWudL0CkDzaJSqg90+ClgXN4oPJ04zhtwBSQ1tDEX3Qtoxh8bHoJiuAtUuLwbN0JQDUXdoWAKquBKCrXdqudFs58FMn4AScgBNwAr0g8Ac2cayynfUsRwAAAABJRU5ErkJggg==';
        break;

      case 'view-as-tree':
        imageRef = 'iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAA4lJREFUWAntlk1sVHUQwH9v9+3HW3b7/UrXAgYs1pISG/GT0NYgAgeBGOIBE4NRg14a75YjUi9qYqpJIYZDMSZGDkbTxKAntGjpAXW7oUBXbaGQtpRu293s92Oasv807FLY7h6M6ST//U/mzdd/ZnZmtJff6HzabmMzBUA6w5WzvR8OFiByf9a9hzsPWQXCnsOd399fY2Ff9Cz7M13D2DULmw10O0Tj4BH82SbY8ghMRqHaq/HOtsasiLoPHvmgR7OsI4qwDGJp2okzJ46/m2VRDry4vZHpeYiL4bUVMBuDbRuhWZLTLFxC5tNLWbHS3cqBjvZFpRf/BbsFN2/DXEIiIU7N+iCSgn31+Q3ffZF6VX6u/FTlQFi+r5Oz/1EIiLE6U4ynweaAeU1u4XzelV9JMVTJ8iL09n6OPJpJOboYc6+B1jLJvwEO4bJLXYzc5S3lpSIwFOrn46+mafS/xMEd26l3woxYkiBQJad6GasPKsJ7C2+pKuVAcDjA1WtBgusCnL3wJesbNnIrrlG/ZgspawNmRZhXm56kee1yrixV/XC4csCdfgGmUoQ1D2G3zuj4BDVVbq7H+6is8nLZ6eCvG0N8c6gjR3NJirBy6+sYTg2vy4Pp9eATJ5wOHcNw4zOcNFQbmGWeHOPFElQE+o+2FatrRfL6Ql/f++bRHwqRtsj0FcK/yvufjoC2ug9k89MdlJ4fu0nMUYfMHiwZSNYCsoDLLNAEt8vpaF6kLf19UCteyiuDtvvMyS7VzVQfaB1uozxxjonbB7ja/hG+2iewJ8EQo7qcmIzm+MJgKDEoB9ynzpGSNu8d/44RM8BzrV9QE93NlQtxxsemGRubJRK18cqp3PWxmFasxvGELB7XfoHfNkG41mAocAwjMcr1vx1MzURJ2sNkdNnLSgwqAhWfdDMdusiwa4Ban5+fB3/EjP/E3Nxb2GQRMasSRGYUe8ncUBq3trRz3i95Dg7g0p3EMvD7rc94/+0mRkZT1JqTRJJSCDyVY/whirDn25Nd7+UICkGl4J/JQU4P9GDIKiQLBBXlNZwP/YFe2c+eXaM81hCi0vwzn46iaCoC8/M3SCejlLv8WJk05UYZbucUX/ed5rUd7aQ0m6zlsi7ngWKKUDkQCvxKW3ozs5ctUrIAtiRb2P34Tjb568gkfLicbhKR0v8PlQP79xU0kfPEYWWk1X1gZXH7P0ndAUjMhqUcVKMvAAAAAElFTkSuQmCC';
        break;
      default:
      break;
    }
    return imageRef;
  }

  function makeWinFormsIcon(e) {
    var img = null;
    if(!e || typeof(e) !== 'string') {
      return null;
    } else if(e.indexOf(':') > -1) {
      var url = new $.System.Uri(e);
      var wr = $.System.Net.WebRequest.Create(url);
      var strm1 = wr.GetResponse().GetResponseStream();
      var bmp = new $.System.Drawing.Bitmap(strm1);
      img = $.System.Drawing.Icon.FromHandle(bmp.GetHicon());
    } else if (e.indexOf('/') > -1 || e.indexOf('.') > -1) {
      if(e[0] !== '/' && process.mainModule) {
        e = path.join(path.dirname(process.mainModule.filename),e);
      }
      var bitmap = new $.System.Drawing.Bitmap(e); // or get it from resource
      img = $.System.Drawing.Icon.FromHandle(bitmap.GetHicon());
    } else {
      var imageRef = getImageFromString(e);
      if(imageRef === null) {
        img = null;
      } else {
        var s = $.System.Convert.FromBase64String(imageRef);
        var ms = new $.System.IO.MemoryStream(s);
        img = new $.System.Drawing.Icon(ms);
      }
    }
    return img;
  }

  function makeImage(e, stretch) {
    var img = null;
    stretch = stretch || $.System.Windows.Media.Stretch.Uniform;
    if(!e || typeof(e) !== 'string') {
     return null;
    } else if(e.indexOf(':') > -1) {
      img = new $.System.Windows.Controls.Image();
      img.Source = $.System.Windows.Media.Imaging.BitmapFrame.Create(new $.System.Uri(e));
      img.Stretch = stretch;
    } else if (e.indexOf('/') > -1 || e.indexOf('.') > -1) {
      if(e[0] !== '/' && process.mainModule) {
        e = path.join(path.dirname(process.mainModule.filename),e);
      }
      img = new $.System.Windows.Controls.Image();
      var strm = $.System.IO.File.OpenRead(e);
      img.Source = $.System.Windows.Media.Imaging.BitmapFrame.Create(strm);
      img.Stretch = stretch;
    } else {
      var imageRef = getImageFromString(e);
      if(imageRef === null) {
        img = null;
      } else {
        img = new $.System.Windows.Controls.Image();
        img.Source = $.System.Windows.Media.Imaging.BitmapFrame.Create(new $.System.IO.MemoryStream($.System.Convert.FromBase64String(imageRef)));
        img.Stretch = stretch;
      }
    }
    return img;
  }

  //TODO: Generalize this to anything with children/control not 
  // specific for WPF, requires fixing/standardizing all menu/menuitems
  // and appendChild etc.
  function forEachItemInControl(control, callback, start, depth) {
    var length = control.Items.Count;
    var i = 0;

    start = typeof(start) === 'undefined' ? 0 : start;
    depth = typeof(depth) === 'undefined' ? 0 : depth;

    for(var c = 0; c < length; c++) {
      var slength = control.Items.Count;
      var obj = control.Items.GetItemAt(c - (length - slength));
      callback(obj, start + i, control.Items, depth);
      i = i + forEachItemInControl(obj, callback, start+i+1, depth+1);
      i++;
    }
    return i;
  }

  function animateWPFProperty(target, property, duration, from, to) {
    var story = new $.System.Windows.Media.Animation.Storyboard();
    var animation = new $.System.Windows.Media.Animation.DoubleAnimation();
    animation.Duration = new $.System.Windows.Duration($.System.TimeSpan.FromMilliseconds(duration))
    animation.From = (from + 0.0000000000001);
    animation.To = (to + 0.000000000001);
    animation.SetValue($.System.Windows.Media.Animation.Storyboard.TargetProperty, target);
    animation.SetValue($.System.Windows.Media.Animation.Storyboard.TargetPropertyProperty, new $.System.Windows.PropertyPath(property));
    story.Children.Add(animation);
    story.Begin(target, $.System.Windows.Media.Animation.HandoffBehavior.Compose);
  }

  function makePropertyBoolTypeOnTarget(obj,name,target,property,truevalue,falsevalue) {
    Object.defineProperty(obj, name, {
      configurable:true,
      enumerable:true,
      get:function() { return target[property] === truevalue ? true : false; },
      set:function(value) { target[property] = value ? truevalue : falsevalue; }
    });
  }

  function makePropertyBoolType(obj,name,property,truevalue,falsevalue) {
    Object.defineProperty(obj, name, {
      configurable:true,
      enumerable:true,
      get:function() { return this.native[property] === truevalue ? true : false; },
      set:function(value) { this.native[property] = value ? truevalue : falsevalue; }
    });
  }

  function makePropertyStringType(obj,name,property) {
    Object.defineProperty(obj, name, {
      configurable:true,
      enumerable:true,
      get:function() { return this.native[property].toString(); },
      set:function(value) { this.native[property] = value.toString(); }
    });
  }

  function makePropertyNumberType(obj,name,property) {
    Object.defineProperty(obj, name, {
      configurable:true,
      enumerable:true,
      get:function() { return this.native[property]; },
      set:function(value) { this.native[property] = value ? value : 0; }
    });
  }

  function makePropertyMapType(obj,name,property,map) {
    Object.defineProperty(obj, name, {
      configurable:true,
      enumerable:true,
      get:function() { 
        var val = this.native[property];
        for(var key in map) {
          if(map.hasOwnProperty(key) && map[key] === val) {
            return key;
          }
        }
        return null;
      },
      set:function(value) {
        assert.ok(map.hasOwnProperty(value), "["+value+"] is not a valid value for "+name+" property.");
        var mappedValue = map[value];
        this.native[property] = mappedValue; 
      }
    });
  }

  function makePropertyImageType(obj,name,property) {
    Object.defineProperty(obj, name, {
      configurable:true,
      enumerable:true,
      get:function() { return this.private['_'+name]; },
      set:function(e) {
        var img = makeImage(e);
        assert.ok(img, 'The image referenced could not be found: '+e);
        assert.ok(img.Source, 'The image referenced could not be decoded: '+e);
        this.private['_'+name] = e;
        this.nativeView[property] = img.Source;
      }
    });
  }

  function updateFont(name) {
    this.nativeView.FontFamily = this.private['_'+name].native.FontFamily;
    this.nativeView.FontStyle = this.private['_'+name].native.Style;
    this.nativeView.FontWeight = this.private['_'+name].native.Weight;
    this.nativeView.Weight = this.private['_'+name].native.Weight;
    this.nativeView.FontStretch = this.private['_'+name].native.FontStretch;
    this.nativeView.FontSize = this.private['_'+name].size;
  }

  function makePropertyFontType(obj,name) {
    Object.defineProperty(obj, name, {
      configurable:true,
      enumerable:true,
      get:function() { 
        if(!this.private['_'+name]) {
          var Font = require('Font');
          this.private['_'+name] = Font.fromWPFObject(this.nativeView);
          this.private['_'+name].addEventListener('font-updated', function() {
            updateFont.call(this, name);
          }.bind(this));
        }
        return this.private['_'+name];
      },
      set:function(e) {
        this.private['_'+name] = Font.parseFont(e);
        updateFont.call(this, name);
        this.private['_'+name].addEventListener('font-updated', function() {
          updateFont.call(this, name);
        }.bind(this));
      }
    });
  }
  baseUtilities.makePropertyFontType = makePropertyFontType;
  baseUtilities.forEachItemInControl = forEachItemInControl;
  baseUtilities.getImageFromString = getImageFromString;
  baseUtilities.makeImage = makeImage;
  baseUtilities.makeWinFormsIcon = makeWinFormsIcon;
  baseUtilities.animateWPFProperty = animateWPFProperty;
  baseUtilities.wpfDeviceToLogicalPx = wpfDeviceToLogicalPx;
  baseUtilities.makePropertyBoolType = makePropertyBoolType;
  baseUtilities.makePropertyBoolTypeOnTarget = makePropertyBoolTypeOnTarget;
  baseUtilities.makePropertyStringType = makePropertyStringType;
  baseUtilities.makePropertyMapType = makePropertyMapType;
  baseUtilities.makePropertyImageType = makePropertyImageType;
  baseUtilities.makePropertyNumberType = makePropertyNumberType;

  global.__TINT.Utilities = baseUtilities;
  return baseUtilities;
})();